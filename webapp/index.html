<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="color-scheme" content="dark only">
    <meta name="theme-color" content="#0B0B0B">
    <title>Aladdin Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&family=Orbitron:wght@400;500;600;700;800;900&family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=100">
    <link rel="stylesheet" href="settings_styles.css?v=100">
    <link rel="stylesheet" href="copytrading_styles.css?v=100">
    <link rel="stylesheet" href="dashboard_styles.css?v=100">
    <link rel="stylesheet" href="coin_config_styles.css?v=100">
</head>

<body>

    <!-- === SPLASH SCREEN === -->
    <div id="splash-screen" onclick="dismissSplash()">
        <div class="splash-content">
            <div class="splash-glow-circle">
                <span class="splash-logo-text">Black<br>Aladdin</span>
            </div>
            <div class="splash-footer">
                <div class="splash-hint">click to start</div>
            </div>
        </div>
        <div class="splash-bg"></div>
    </div>

    <!-- === PAGE: HOME === -->
    <div id="home" class="page active animate-enter">
        <header class="home-header"
            style="display: flex; flex-direction: column; align-items: center; text-align: center; padding-top: 40px;">
            <h1
                style="font-family: 'Montserrat', sans-serif; font-weight: 800; font-size: 32px; letter-spacing: -0.5px; margin: 0; color: white;">
                Black Aladin</h1>
            <p
                style="font-family: 'Montserrat', sans-serif; font-size: 14px; color: rgba(255,255,255,0.7); margin-top: 4px;">
                Your Smart Trading Genie...</p>

            <div class="user-profile-left" style="display:none;">
                <div id="user-avatar" class="avatar-circle">K</div>
                <div class="user-texts">
                    <div class="text-caption" data-i18n="welcome">Welcome Back</div>
                    <div id="user-name" class="user-name-text">Trader</div>
                </div>
            </div>
        </header>

        <!-- === PORTFOLIO SECTION === -->
        <div class="portfolio-section">
            <div class="portfolio-label" data-i18n="lbl_total_balance">Portfolio Value</div>
            <div id="total-balance" class="portfolio-amount">$0.00</div>
            <!-- Removed 24h change as requested -->
        </div>

        <!-- === ACTION BUTTONS === -->
        <div class="home-actions">

            <!-- COPY TRADING -->
            <div id="btn-copy-trading" class="action-card">
                <div class="icon-circle">
                    <img src="exchange_icon_white.svg" class="action-icon-svg">
                </div>
                <div class="action-label" data-i18n="btn_copy_trade">Copy Trading</div>
            </div>

            <!-- TOP UP -->
            <div class="action-card" data-action="topup">
                <div class="icon-circle">
                    <img src="top_up.svg" class="action-icon-svg">
                </div>
                <div class="action-label" data-i18n="btn_topup">Top Up Fees</div> <!-- Updated Text -->
            </div>



            <!-- ANALYZE CHART -->
            <div class="action-card" data-action="analyze">
                <div class="icon-circle">
                    <img src="copy_trade.svg" class="action-icon-svg">
                </div>
                <div class="action-label" data-i18n="btn_analyze">Analyze</div>
            </div>
        </div>

        <div style="padding: 24px 20px 80px;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
                <div class="section-title" data-i18n="active_strategies">Active Strategies</div>
                <div class="view-all" data-i18n="view_all">View All</div>
            </div>
            <div id="active-strategies-list">
                <!-- Example Item (Populated by JS) -->
                <!-- 
                <div class="strategy-item">
                    <div class="strat-icon">
                        <img src="logo_bots/okx.png">
                    </div>
                    <div class="strat-info">
                        <div class="strat-title">TradeMax</div>
                        <div class="strat-desc">OKX Spot</div>
                    </div>
                    <div class="strat-status text-yellow">Waiting TopUp</div>
                </div> 
                -->
                <div style="text-align:center; padding:20px; color:#888; font-size:14px;">No active strategies</div>
            </div>
        </div>
    </div>

    <!-- ... EXCHANGES & PROFILE PAGES (Unchanged structure, mainly CSS) ... -->

    <!-- === PAGE: EXCHANGES === -->
    <div id="exchanges" class="page">
        <!-- Header (Replicated from Home) -->
        <header class="home-header">
            <div class="user-profile-left">
                <div id="user-avatar-exchanges" class="avatar-circle">K</div>
                <div class="user-texts">
                    <div class="text-caption" data-i18n="welcome">Welcome Back</div>
                    <div id="user-name-exchanges" class="user-name-text">Trader</div>
                </div>
            </div>
        </header>

        <div style="padding: 24px 20px 80px;">
            <div class="section-title" data-i18n="my_exchanges" style="margin-bottom:16px;">My Exchanges</div>
            <div id="exchange-list">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- === PAGE: PROFILE (Settings) === -->
    <div id="profile" class="page">
        <!-- Replicated Header from Home -->
        <header class="home-header" style="padding-top: 20px;">
            <div class="user-profile-left">
                <div id="user-avatar-settings" class="avatar-circle">K</div>
                <div class="user-texts">
                    <div class="text-caption" data-i18n="welcome">Welcome Back</div>
                    <div id="user-name-settings" class="user-name-text">Trader</div>
                </div>
            </div>
        </header>

        <div style="padding: 20px;">
            <!-- Settings Title -->
            <div style="font-size: 20px; font-weight: 400; color: #fff; margin-bottom: 16px; font-family: 'Montserrat', sans-serif;"
                data-i18n="settings">Settings</div>

            <!-- Settings Info Card (Glass) -->
            <div class="settings-card">
                <!-- Row 1: User ID -->
                <div class="settings-row">
                    <span class="settings-label" data-i18n="user_id">User ID</span>
                    <span id="user-id-disp-settings" class="settings-value">7777777</span>
                </div>

                <!-- Divider -->
                <div class="settings-divider"></div>

                <!-- Row 2: Fees Balance -->
                <div class="settings-row">
                    <span class="settings-label" data-i18n="lbl_alladeen_fees">USDT Balance</span>
                    <!-- "Balance USDT" requested, using key which maps to it -->
                    <span id="credits-bal-settings" class="settings-value">0.0</span>
                </div>

                <!-- Divider -->
                <div class="settings-divider"></div>

                <!-- Row 3: UNC Balance -->
                <div class="settings-row">
                    <span class="settings-label">UNC Balance</span>
                    <span id="unc-bal-settings" class="settings-value" style="color: #00ff9d;">0.0</span>
                </div>
            </div>

            <!-- Language Section -->
            <div style="margin-top: 32px;">
                <div style="font-size: 16px; color: #fff; margin-bottom: 12px; font-family: 'Montserrat', sans-serif;"
                    data-i18n="language">Language</div>
                <div style="display:flex; gap:12px;">
                    <div class="lang-btn" data-lang="en">EN</div>
                    <div class="lang-btn" data-lang="ru">RU</div>
                    <div class="lang-btn" data-lang="uk">UK</div>
                </div>
            </div>

            <!-- Withdraw Funds Section -->
            <div style="margin-top: 32px;">
                <button id="btn-withdraw-funds"
                    style="width: 100%; padding: 16px; background: linear-gradient(135deg, #FF6B6B 0%, #EE5A52 100%); border: none; border-radius: 16px; color: white; font-weight: 600; font-size: 16px; cursor: pointer; font-family: 'Montserrat', sans-serif; box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); transition: transform 0.2s;"
                    data-i18n="btn_withdraw">
                    Withdraw Funds
                </button>
            </div>

            <!-- Referral Section -->
            <div style="margin-top: 16px;">
                <button id="btn-referral"
                    style="width: 100%; padding: 16px; background: linear-gradient(135deg, #0660F9 0%, #0550D9 100%); border: none; border-radius: 16px; color: white; font-weight: 600; font-size: 16px; cursor: pointer; font-family: 'Montserrat', sans-serif; box-shadow: 0 4px 12px rgba(6, 96, 249, 0.3); transition: transform 0.2s;"
                    data-i18n="get_referral_link">
                    Get Your Referral Link
                </button>
            </div>
        </div>
    </div>

    <!-- === TOPUP MODAL (Bottom Sheet) === -->
    <div id="modal-topup" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; height: 580px; width: 100%; max-width: 480px; margin: 0 auto;">

            <!-- Close Button -->
            <div id="btn-close-topup" class="close-modal-btn" onclick="closeModal('modal-topup')">✕</div>

            <!-- Header -->
            <h2 style="font-family: 'Montserrat', sans-serif; font-size: 20px; margin-bottom: 24px; text-align: center;"
                data-i18n="top_up_title">Top Up Balance</h2>

            <!-- Coin Selector Button -->
            <div class="coin-selector-btn"
                style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                <img src="usdt_bep_icon.svg" width="32" height="32">
                <span style="font-size: 16px; font-weight: 600;">USDT (BEP 20)</span>
            </div>

            <!-- Instruction (Moved Up) -->
            <div style="margin-bottom: 24px; text-align: left;">
                <h3 style="font-size: 14px; color: #fff; margin-bottom: 8px;" data-i18n="top_up_purpose_header">Purpose
                    of Top Up</h3>
                <div style="color: #9CA3AF; font-size: 13px; line-height: 1.5;" data-i18n="top_up_purpose_desc">
                    This balance is used to pay for service fees and copy-trading commissions.
                    <br><br>
                    Sending USDT to the address below will automatically credit your account.
                </div>
            </div>

            <!-- Address Section -->
            <div class="address-section" style="margin-bottom: 24px;">
                <div style="color: #467EE7; font-size: 12px; margin-bottom: 8px;" data-i18n="address_label">Address
                </div>
                <div
                    style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 8px; border-bottom: 1px solid #2A2938;">
                    <div id="deposit-address-text"
                        style="font-family: 'Inconsolata', monospace; font-size: 14px; word-break: break-all; color: #fff;">
                        Generating...
                    </div>
                    <div onclick="copyAddress()" style="cursor: pointer; padding: 4px;">
                        <img src="copy_icon.svg" width="20" height="20">
                    </div>
                </div>
            </div>

            <!-- Instruction -->
            <div style="color: #6B7280; font-size: 13px; line-height: 1.5; text-align: center;"
                data-i18n="instruction_bottom">
                Send USDT (BEP-20) to this address.<br>
                The balance will be credited automatically.
            </div>

            <!-- Spacing for safe area -->
            <div style="height: 20px;"></div>
        </div>
    </div>

    <!-- === MODAL: WITHDRAW FUNDS === -->
    <div id="modal-withdraw" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; width: 100%; max-width: 480px; margin: 0 auto; display: flex; flex-direction: column; max-height: 85vh; overflow-y: auto;">

            <!-- Close Button -->
            <div class="close-modal-btn" onclick="closeWithdrawModal()">✕</div>

            <!-- Header -->
            <h2 style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 24px; text-align: center; color: white;"
                data-i18n="withdraw_title">Withdraw USDT</h2>

            <!-- Available Balance Display -->
            <div
                style="background: rgba(255, 107, 107, 0.1); border-radius: 12px; padding: 16px; margin-bottom: 24px; text-align: center;">
                <div style="color: #9CA3AF; font-size: 12px; margin-bottom: 4px;" data-i18n="available_balance">
                    Available Balance</div>
                <div id="withdraw-available-balance" style="color: #FF6B6B; font-size: 24px; font-weight: 700;">0.00
                    USDT</div>
            </div>

            <!-- Amount Input -->
            <div style="margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <div style="color: #fff; font-size: 14px; font-weight: 500;" data-i18n="withdraw_amount_label">
                        Amount (USDT)</div>
                </div>

                <div
                    style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <input type="number" id="withdraw-amount" placeholder="0.00" step="0.01"
                        style="background: transparent; border: none; color: #fff; font-size: 16px; font-weight: 600; width: 100%; outline: none; font-family: 'Montserrat', sans-serif;">

                    <div style="display: flex; align-items: center; gap: 8px;">
                        <button onclick="setWithdrawMax()"
                            style="background: rgba(255, 107, 107, 0.1); color: #FF6B6B; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; font-weight: 600; cursor: pointer;">MAX</button>
                        <span style="font-size: 16px; font-weight: 600; color: #fff;">USDT</span>
                    </div>
                </div>
            </div>

            <!-- Wallet Address Input -->
            <div style="margin-bottom: 24px;">
                <div style="color: #fff; font-size: 14px; margin-bottom: 8px; font-weight: 500;"
                    data-i18n="withdraw_wallet_label">
                    Wallet Address (BEP-20)
                </div>
                <div style="background: #1A1926; border-radius: 16px; padding: 16px;">
                    <input type="text" id="withdraw-wallet" placeholder="0x..."
                        style="background: transparent; border: none; color: #fff; font-size: 14px; width: 100%; outline: none; font-family: 'Inconsolata', monospace;">
                </div>
                <div style="font-size: 12px; color: #6B7280; margin-top: 8px;">
                    Enter your BEP-20 wallet address (starts with 0x)
                </div>
            </div>

            <!-- Submit Button -->
            <div style="margin-top: auto;">
                <button onclick="submitWithdrawRequest()" class="btn-primary"
                    style="width: 100%; padding: 16px; border-radius: 16px; background: linear-gradient(135deg, #FF6B6B 0%, #EE5A52 100%); color: white; border: none; font-weight: 600; font-size: 16px; box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); font-family: 'Montserrat', sans-serif;"
                    data-i18n="withdraw_submit">
                    Submit Request
                </button>

                <!-- Spacing for safe area -->
                <div style="height: 100px;"></div>
            </div>
        </div>
    </div>

    <!-- === MODAL: REFERRAL === -->
    <div id="modal-referral" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; width: 100%; max-width: 480px; margin: 0 auto;">

            <!-- Close Button -->
            <div class="close-modal-btn" onclick="closeReferralModal()">✕</div>

            <!-- Header -->
            <h2 style="font-family: 'Montserrat', sans-serif; font-size: 20px; margin-bottom: 24px; text-align: center; color: white;"
                data-i18n="referral_program">
                Referral Program
            </h2>

            <!-- Referral Link Box -->
            <div class="referral-link-box"
                style="background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 12px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <span id="referral-link"
                    style="font-family: 'Inconsolata', monospace; font-size: 13px; color: #fff; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1;">
                    https://t.me/bot?start=...
                </span>
                <img src="copy_icon.svg" width="20" height="20" onclick="copyReferralLink()"
                    style="cursor: pointer; opacity: 0.7; transition: opacity 0.2s; margin-left: 12px;">
            </div>

            <!-- Commission Tiers Info -->
            <div
                style="background: rgba(6, 96, 249, 0.1); border-left: 3px solid #0660F9; border-radius: 8px; padding: 12px; margin-bottom: 24px;">
                <div style="font-size: 13px; color: #9CA3AF; line-height: 1.5;" data-i18n="referral_earn_text">
                    Earn commission from your referrals' profitable trades:
                </div>
            </div>

            <!-- Tier List -->
            <div class="tier-list" style="display: flex; flex-direction: column; gap: 12px;">
                <div class="tier-item"
                    style="background: rgba(255, 255, 255, 0.03); border-radius: 12px; padding: 16px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-size: 15px; color: #fff; font-weight: 600;" data-i18n="level_1">Level 1</div>
                        <div style="font-size: 12px; color: #9CA3AF;" data-i18n="commission_20">20% commission</div>
                    </div>
                    <div id="level-1-count" style="font-size: 16px; font-weight: 700; color: #0660F9;">0 referrals</div>
                </div>

                <div class="tier-item"
                    style="background: rgba(255, 255, 255, 0.03); border-radius: 12px; padding: 16px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-size: 15px; color: #fff; font-weight: 600;" data-i18n="level_2">Level 2</div>
                        <div style="font-size: 12px; color: #9CA3AF;" data-i18n="commission_7">7% commission</div>
                    </div>
                    <div id="level-2-count" style="font-size: 16px; font-weight: 700; color: #0660F9;">0 referrals</div>
                </div>

                <div class="tier-item"
                    style="background: rgba(255, 255, 255, 0.03); border-radius: 12px; padding: 16px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-size: 15px; color: #fff; font-weight: 600;" data-i18n="level_3">Level 3</div>
                        <div style="font-size: 12px; color: #9CA3AF;" data-i18n="commission_3">3% commission</div>
                    </div>
                    <div id="level-3-count" style="font-size: 16px; font-weight: 700; color: #0660F9;">0 referrals</div>
                </div>
            </div>

            <!-- Spacing for safe area -->
            <div style="height: 100px;"></div>
        </div>
    </div>


    <!-- === MODAL: COPY TRADING === -->
    <div id="modal-copytrading" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; height: 580px; width: 100%; max-width: 480px; margin: 0 auto;">

            <!-- Close Button -->
            <div class="close-modal-btn" onclick="closeCopyTradingModal()">✕</div>
            <!-- <div id="btn-close-topup" class="close-modal-btn" onclick="closeModal('modal-copytrading')">✕</div> -->


            <!-- Title -->
            <h2 style="font-family: 'Montserrat', sans-serif; font-size: 20px; margin-bottom: 24px; text-align: center;"
                data-i18n="wiz_title">Setup Copytrading</h2>

            <!-- Step 0: Market Type Selection -->
            <div id="ct-step-market-type" class="ct-step">

                <!-- Futures Card -->
                <div class="market-type-selector" data-market="futures"
                    style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div
                            style="width: 40px; height: 40px; background: rgba(6, 96, 249, 0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                            <img src="usdt_bep_icon.svg" width="32" height="32">
                        </div>
                        <div>
                            <div style="font-size: 16px; font-weight: 600; color: #fff;">Futures</div>
                            <div style="font-size: 13px; color: #9CA3AF;">Leverage trading</div>
                        </div>
                    </div>
                    <div style="font-size: 20px; color: #467EE7;">→</div>
                </div>

                <!-- Spot Card -->
                <div class="market-type-selector" data-market="spot"
                    style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div
                            style="width: 40px; height: 40px; background: rgba(6, 96, 249, 0.1); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                            <img src="usdt_bep_icon.svg" width="32" height="32">
                        </div>
                        <div>
                            <div style="font-size: 16px; font-weight: 600; color: #fff;">Spot</div>
                            <div style="font-size: 13px; color: #9CA3AF;">Direct trading</div>
                        </div>
                    </div>
                    <div style="font-size: 20px; color: #467EE7;">→</div>
                </div>
            </div>

            <!-- Step 1: Strategy Selection -->
            <div id="ct-step-strategy" class="ct-step" style="display:none;">
                <button class="modal-back-btn" onclick="showCTStep('market-type')">← Back</button>


                <!-- BingBot Strategy -->
                <div class="strategy-selector-btn" data-strategy="bingbot" data-exchange="bingx"
                    style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <img src="usdt_bep_icon.svg" width="32" height="32">
                        <div>
                            <div style="font-size: 16px; font-weight: 600; color: #fff;">BingBot</div>
                            <div style="font-size: 13px; color: #9CA3AF;">BingX Only</div>
                        </div>
                    </div>
                    <div style="font-size: 14px; color: #467EE7; font-weight: 500;">Futures</div>
                </div>

                <!-- TradeMax Strategy -->
                <div class="strategy-selector-btn" data-strategy="trademax" data-exchange="okx"
                    style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <img src="usdt_bep_icon.svg" width="32" height="32">
                        <div>
                            <div style="font-size: 16px; font-weight: 600; color: #fff;">TradeMax</div>
                            <div style="font-size: 13px; color: #9CA3AF;">OKX Only</div>
                        </div>
                    </div>
                    <div style="font-size: 14px; color: #467EE7; font-weight: 500;">Spot</div>
                </div>
            </div>

            <!-- Step 2: API Configuration (BingX) -->
            <div id="ct-step-bingx-api" class="ct-step" style="display:none;">
                <button class="modal-back-btn" onclick="showCTStep('strategy')">← Back</button>

                <h2
                    style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 8px; text-align: center;">
                    BingX API Setup</h2>

                <!-- 1. Get API Link -->
                <a href="https://www.bingx.com/en-us/account/api/" target="_blank"
                    style="display:block; text-align:center; color:#467EE7; font-size:14px; margin-bottom:20px; text-decoration:none;">
                    Get API Keys ↗
                </a>

                <!-- 2. Whitelist IP Box -->
                <div style="margin-bottom:24px;">
                    <label class="ct-label" style="text-align:center;">Whitelist this IP Address</label>
                    <div class="address-box" onclick="copyText('167.99.130.80')"
                        style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 12px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);">
                        <span
                            style="font-family: 'Inconsolata', monospace; font-size: 16px; letter-spacing: 1px; color:#fff;">167.99.130.80</span>
                        <img src="copy_icon.svg" width="20" height="20" style="opacity: 0.7;">
                    </div>
                </div>


                <div class="ct-input-group">
                    <label class="ct-label">API Key</label>
                    <input type="text" id="bingx-api-key" class="ct-input" placeholder="Enter API Key">
                </div>

                <div class="ct-input-group">
                    <label class="ct-label">Secret Key</label>
                    <input type="password" id="bingx-secret-key" class="ct-input" placeholder="Enter Secret Key">
                </div>

                <div class="ct-input-group">
                    <label class="ct-label">Trading Capital (USDT)</label>
                    <input type="number" id="bingx-capital" class="ct-input" placeholder="0.00" step="0.01">
                    <div style="font-size: 12px; color: #6B7280; margin-top: 4px;">
                        Set the amount you want to allocate for trading
                    </div>
                    <div style="font-size: 13px; color: #FF9F0A; margin-top: 8px; font-weight: 500;"
                        data-i18n="min_balance_warning">
                        Minimum trading balance: 100 USDT
                    </div>
                </div>

                <button class="ct-submit-btn" onclick="submitBingXAPI()">Connect BingX</button>
            </div>

            <!-- Step 3: API Configuration (OKX) -->
            <div id="ct-step-okx-api" class="ct-step" style="display:none;">
                <button class="modal-back-btn" onclick="showCTStep('strategy')">← Back</button>

                <h2
                    style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 8px; text-align: center;">
                    OKX Setup</h2>

                <!-- 1. Get API Link -->
                <a href="https://www.okx.com/account/my-api" target="_blank"
                    style="display:block; text-align:center; color:#467EE7; font-size:14px; margin-bottom:20px; text-decoration:none;">
                    Get API Keys ↗
                </a>

                <!-- 2. Whitelist IP Box -->
                <div style="margin-bottom:24px;">
                    <label class="ct-label" style="text-align:center;">Whitelist this IP Address</label>
                    <div class="address-box" onclick="copyText('167.99.130.80')"
                        style="background: rgba(255,255,255,0.05); border-radius: 12px; padding: 12px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);">
                        <span
                            style="font-family: 'Inconsolata', monospace; font-size: 16px; letter-spacing: 1px; color:#fff;">167.99.130.80</span>
                        <img src="copy_icon.svg" width="20" height="20" style="opacity: 0.7;">
                    </div>
                </div>

                <div class="ct-input-group">
                    <label class="ct-label">API Key</label>
                    <input type="text" id="okx-api-key" class="ct-input" placeholder="Enter API Key">
                </div>

                <div class="ct-input-group">
                    <label class="ct-label">Secret Key</label>
                    <input type="password" id="okx-secret-key" class="ct-input" placeholder="Enter Secret Key">
                </div>

                <div class="ct-input-group">
                    <label class="ct-label">Passphrase</label>
                    <input type="password" id="okx-passphrase" class="ct-input" placeholder="Enter Passphrase">
                </div>

                <button class="ct-submit-btn" onclick="proceedToCoinSelection()">Next: Select Coins</button>
            </div>

            <!-- Step 4: Coin Selection (NEW) -->
            <div id="ct-step-coin-select" class="ct-step" style="display:none;">
                <button class="modal-back-btn" onclick="showCTStep('okx-api')">← Back</button>

                <h2
                    style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 8px; text-align: center;">
                    Select Coins to Copy</h2>
                <p style="text-align: center; color: #9CA3AF; font-size: 13px; margin-bottom: 24px;">
                    Choose which coins you want to copy trade (minimum $100 per coin)
                </p>

                <!-- Coin Grid -->
                <div class="coin-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px;">
                    <div class="coin-card" data-symbol="BTC/USDT" onclick="toggleCoin('BTC/USDT')">
                        <div class="coin-checkbox">✓</div>
                        <img src="coin_img/bitcoin.png" width="48" height="48" style="margin-bottom: 8px;">
                        <div style="font-size: 14px; font-weight: 600; color: #fff;">Bitcoin</div>
                        <div style="font-size: 12px; color: #9CA3AF;">BTC/USDT</div>
                    </div>

                    <div class="coin-card" data-symbol="ETH/USDT" onclick="toggleCoin('ETH/USDT')">
                        <div class="coin-checkbox">✓</div>
                        <img src="coin_img/ethereum.png" width="48" height="48" style="margin-bottom: 8px;">
                        <div style="font-size: 14px; font-weight: 600; color: #fff;">Ethereum</div>
                        <div style="font-size: 12px; color: #9CA3AF;">ETH/USDT</div>
                    </div>

                    <div class="coin-card" data-symbol="BNB/USDT" onclick="toggleCoin('BNB/USDT')">
                        <div class="coin-checkbox">✓</div>
                        <img src="coin_img/bnb.png" width="48" height="48" style="margin-bottom: 8px;">
                        <div style="font-size: 14px; font-weight: 600; color: #fff;">BNB</div>
                        <div style="font-size: 12px; color: #9CA3AF;">BNB/USDT</div>
                    </div>

                    <div class="coin-card" data-symbol="OKB/USDT" onclick="toggleCoin('OKB/USDT')">
                        <div class="coin-checkbox">✓</div>
                        <img src="coin_img/okb.png" width="48" height="48" style="margin-bottom: 8px;">
                        <div style="font-size: 14px; font-weight: 600; color: #fff;">OKB</div>
                        <div style="font-size: 12px; color: #9CA3AF;">OKB/USDT</div>
                    </div>
                </div>

                <button class="ct-submit-btn" onclick="proceedToCoinConfig()" id="btn-coin-next" disabled>
                    Next: Configure Coins
                </button>
            </div>

            <!-- Step 5: Coin Configuration (Clean Layout) -->
            <div id="ct-step-coin-config" class="ct-step" style="display:none; height: 100%; flex-direction: column;">
                <!-- Header with Back Button (Close is handled by parent modal) -->
                <div style="display: flex; align-items: center; margin-bottom: 16px; position: relative;">
                    <div onclick="showCTStep('coin-select')"
                        style="display: flex; align-items: center; color: #3B82F6; cursor: pointer; font-size: 16px; font-weight: 500; z-index: 10;">
                        <span style="margin-right: 4px; font-size: 20px;">←</span> <span data-i18n="back">Back</span>
                    </div>
                    <h2 style="font-family: 'Montserrat', sans-serif; font-size: 18px; font-weight: 700; margin: 0; color: white; position: absolute; left: 0; right: 0; text-align: center; pointer-events: none;"
                        data-i18n="configure_coins">Configure Coins</h2>
                </div>

                <!-- Scrollable Coin List -->
                <div id="coin-config-list"
                    style="flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 16px; padding-bottom: 24px; margin-bottom: 16px;">
                    <!-- Dynamically populated -->
                </div>

                <!-- Sticky Connect Button -->
                <button class="ct-submit-btn" onclick="submitOKXWithCoins()" data-i18n="connect_okx"
                    style="width: 100%; height: 50px; font-size: 16px; font-weight: 600; margin-top: auto;">Connect
                    OKX</button>
            </div>

            <!-- Spacing for safe area -->
            <div style="height: 100px;"></div>
        </div>
    </div>
    <!-- === MODAL: STRATEGY SETTINGS === -->
    <div id="modal-strategy-settings" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; width: 100%; max-width: 480px; margin: 0 auto; display: flex; flex-direction: column; max-height: 85vh; overflow-y: auto;">

            <!-- Close Button (Top Right) -->
            <div class="close-modal-btn" onclick="closeStrategySettings()">✕</div>

            <!-- Header -->
            <h2 style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 24px; text-align: center; color: white;"
                data-i18n="settings">Strategy Settings</h2>

            <!-- Exchange Card (Matches Coin Selector) -->
            <div
                style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                <div id="st-set-icon"
                    style="width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;">
                    <img src="" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div style="flex: 1;">
                    <div id="st-set-name" style="font-size: 16px; font-weight: 600; color: #fff;">Exchange</div>
                </div>
                <!-- Status Pilled on the right -->
                <div id="st-set-status"
                    style="font-size: 13px; font-weight: 600; color: #06D6A0; background: rgba(6, 214, 160, 0.1); padding: 4px 8px; border-radius: 6px;">
                    Active
                </div>
            </div>

            <!-- Capital Input Section -->
            <div style="margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                    <div style="color: #fff; font-size: 14px; font-weight: 500;" data-i18n="lbl_trading_capital">Trading
                        Capital</div>
                    <div id="st-set-balance" style="color: #9CA3AF; font-size: 12px;">Available: 0.00 USDT</div>
                </div>

                <div
                    style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <input type="number" id="st-set-reserve" placeholder="0.00" step="0.01"
                        style="background: transparent; border: none; color: #fff; font-size: 16px; font-weight: 600; width: 100%; outline: none; font-family: 'Montserrat', sans-serif;">

                    <div style="display: flex; align-items: center; gap: 8px;">
                        <button onclick="setCapitalMax()"
                            style="background: rgba(70, 126, 231, 0.1); color: #467EE7; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; font-weight: 600; cursor: pointer;">MAX</button>
                        <span style="font-size: 16px; font-weight: 600; color: #fff;">USDT</span>
                    </div>
                </div>

                <!-- Capital Slider -->
                <div style="position: relative; height: 24px; display: flex; align-items: center;">
                    <input type="range" id="st-set-reserve-slider" min="0" step="0.01" value="0" class="slider-range"
                        style="z-index: 2;">
                </div>

                <div style="font-size: 13px; color: #9CA3AF; margin-top: 8px; line-height: 1.4;"
                    data-i18n="msg_edit_reserve_prompt">
                    Amount reserved for this strategy.
                </div>
            </div>

            <!-- Risk Slider -->
            <div style="margin-bottom: 32px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 12px; align-items: center;">
                    <span style="font-size: 14px; color: #fff; font-weight: 500;" data-i18n="lbl_risk_per_trade">Risk
                        per Trade</span>
                    <span id="st-set-risk-val" style="font-size: 14px; font-weight: 600; color: #06D6A0;">1%</span>
                </div>

                <!-- Custom Slider Track -->
                <div style="position: relative; height: 24px; display: flex; align-items: center;">
                    <input type="range" id="st-set-risk" min="0.5" max="5" step="0.5" value="1" class="slider-range"
                        style="z-index: 2;">
                </div>

                <div style="font-size: 13px; color: #9CA3AF; margin-top: 8px;" data-i18n="msg_edit_risk_prompt">
                    Percentage of capital risking per trade.
                </div>
            </div>

            <!-- Actions (Disconnect ABOVE Apply) -->
            <div style="margin-top: auto; padding-bottom: 20px;">
                <button onclick="disconnectStrategy()"
                    style="width: 100%; padding: 16px; background: rgba(255, 77, 77, 0.05); color: #FF4D4D; border: none; border-radius: 16px; font-weight: 600; font-size: 16px; margin-bottom: 12px; font-family: 'Montserrat', sans-serif;"
                    data-i18n="btn_disconnect">
                    Disconnect Strategy
                </button>

                <button class="btn-primary" onclick="saveStrategySettings()"
                    style="width: 100%; padding: 16px; border-radius: 16px; background: #467EE7; color: white; border: none; font-weight: 600; font-size: 16px; box-shadow: 0 4px 12px rgba(70, 126, 231, 0.3); font-family: 'Montserrat', sans-serif;"
                    data-i18n="btn_apply_changes">
                    Apply Changes
                </button>

                <!-- Spacing for safe area -->
                <div style="height: 100px;"></div>
            </div>
        </div>
    </div>

    <!-- First modal-manage-coins REMOVED (was duplicate/incomplete) -->

    <!-- === TOAST NOTIFICATION === -->
    <div id="toast-notification" class="toast-notification">Address Copied!</div>
    <div id="toast" class="toast hidden"
        style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #06D6A0; color: white; padding: 12px 24px; border-radius: 8px; z-index: 10000; display: none;">
        Toast</div>

    <!-- ... Modals (Reserve/Topup) ... -->

    <!-- === MODAL: EDIT COIN === -->
    <div id="modal-edit-coin" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; width: 100%; max-width: 480px; margin: 0 auto; display: flex; flex-direction: column; max-height: 85vh; overflow-y: auto;">

            <!-- Close Button -->
            <div class="close-modal-btn" onclick="closeEditCoinModal()">&#x2715;</div>

            <!-- Header -->
            <h2
                style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 24px; text-align: center; color: white;"
                data-i18n="edit_coin_title">
                Edit Coin
            </h2>

            <!-- Coin Info -->
            <div
                style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                <div id="ec-icon" style="width: 32px; height: 32px;">
                    <img src="" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div style="flex: 1;">
                    <div id="ec-symbol" style="font-size: 16px; font-weight: 600; color: #fff;">BTC/USDT</div>
                    <div id="ec-exchange" style="font-size: 12px; color: #9CA3AF;">OKX</div>
                </div>
            </div>

            <!-- Inputs -->
            <div class="ct-input-group">
                <label class="ct-label" data-i18n="trading_capital_label">Trading Capital (USDT)</label>
                <input type="number" id="ec-capital" class="ct-input" placeholder="0.00" step="0.01">
            </div>

            <div class="ct-input-group">
                <label class="ct-label" data-i18n="risk_per_trade_label">Risk per Trade (%)</label>
                <input type="number" id="ec-risk" class="ct-input" placeholder="1.0" step="0.1" max="10">
            </div>

            <!-- Actions -->
            <div style="margin-top: auto;">
                <button onclick="deleteEditCoin()"
                    style="width: 100%; padding: 16px; background: rgba(255, 77, 77, 0.05); color: #FF4D4D; border: none; border-radius: 16px; font-weight: 600; font-size: 16px; margin-bottom: 12px; font-family: 'Montserrat', sans-serif; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <img src="trash_bin.svg" width="18" height="18" style="filter: brightness(0) saturate(100%) invert(38%) sepia(95%) saturate(1439%) hue-rotate(335deg) brightness(97%) contrast(101%);">
                    <span data-i18n="btn_remove_coin">Remove Coin</span>
                </button>

                <button class="btn-primary" onclick="submitEditCoin()"
                    style="width: 100%; padding: 16px; border-radius: 16px; background: #467EE7; color: white; border: none; font-weight: 600; font-size: 16px; box-shadow: 0 4px 12px rgba(70, 126, 231, 0.3);"
                    data-i18n="btn_save_changes">
                    Save Changes
                </button>
                <div style="height: 40px;"></div>
            </div>
        </div>
    </div>

    <!-- === MODAL: ADD COIN === -->
    <div id="modal-add-coin" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; width: 100%; max-width: 480px; margin: 0 auto; display: flex; flex-direction: column; max-height: 85vh; overflow-y: auto;">

            <!-- Close Button -->
            <div class="close-modal-btn" onclick="closeAddCoinModal()">&#x2715;</div>

            <!-- Header -->
            <h2
                style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; margin-bottom: 24px; text-align: center; color: white;"
                data-i18n="add_coin_title">
                Add Coin
            </h2>

            <!-- Coin Info -->
            <div
                style="background: #1A1926; border-radius: 16px; padding: 16px; display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                <div id="ac-icon" style="width: 32px; height: 32px;">
                    <img src="" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div style="flex: 1;">
                    <div id="ac-symbol" style="font-size: 16px; font-weight: 600; color: #fff;">BTC/USDT</div>
                    <div id="ac-exchange" style="font-size: 12px; color: #9CA3AF;">OKX</div>
                </div>
            </div>

            <!-- Inputs -->
            <div class="ct-input-group">
                <label class="ct-label" data-i18n="trading_capital_label">Trading Capital (USDT)</label>
                <input type="number" id="ac-capital" class="ct-input" placeholder="0.00" step="0.01">
            </div>

            <div class="ct-input-group">
                <label class="ct-label" data-i18n="risk_per_trade_label">Risk per Trade (%)</label>
                <input type="number" id="ac-risk" class="ct-input" placeholder="1.0" step="0.1" max="10">
            </div>

            <!-- Actions -->
            <div style="margin-top: auto;">
                <button class="btn-primary" onclick="submitAddCoin()"
                    style="width: 100%; padding: 16px; border-radius: 16px; background: #467EE7; color: white; border: none; font-weight: 600; font-size: 16px; box-shadow: 0 4px 12px rgba(70, 126, 231, 0.3);"
                    data-i18n="add_coin_title">
                    Add Coin
                </button>
                <div style="height: 40px;"></div>
            </div>
        </div>
    </div>

    <!-- === MODAL: MANAGE COINS === -->
    <div id="modal-manage-coins" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; width: 100%; max-width: 480px; margin: 0 auto; display: flex; flex-direction: column; max-height: 95vh; overflow-y: scroll; -webkit-overflow-scrolling: touch;">

            <div class="close-modal-btn" onclick="closeManageCoins()">&#x2715;</div>

            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                <div id="mc-exchange-icon"
                    style="width: 40px; height: 40px; background: #1A1926; border-radius: 50%; padding: 8px;">
                    <img src="" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <div>
                    <h2 id="mc-exchange-name"
                        style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 700; color: white;">
                        OKX</h2>
                    <div style="font-size: 13px; color: #9CA3AF;" data-i18n="manage_allocations">Manage Allocations</div>
                </div>
            </div>

            <!-- List of Configured Coins -->
            <div id="existing-coins-list"
                style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px;">
                <!-- Populated by JS -->
            </div>

            <!-- Add Coin Section -->
            <button class="btn-add-coin" onclick="showAddCoinSelector()"
                style="margin: 0 auto; display: block; width: 100%;">+ Add New Coin</button>

            <!-- Coin Selector (Moved here for context) -->
            <div id="add-coin-selector" style="display:none; margin-top: 24px;">
                <h3 style="font-size: 16px; font-weight: 600; color: #fff; margin-bottom: 16px;">Select Coin to Add</h3>
                <div class="coin-grid" id="available-coins-grid">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <div style="height: 40px;"></div>
        </div>
    </div>

    <!-- === BOTTOM NAV (Animated) === -->
    <nav class="bottom-nav-bar">
        <div class="nav-items-container">
            <div class="nav-item" data-target="exchanges">
                <div class="nav-circle"></div> <!-- Per-item Circle -->
                <div class="nav-icon-box">
                    <img src="exchange_icon.svg" class="nav-icon-svg">
                </div>
            </div>
            <div class="nav-item active" data-target="home">
                <div class="nav-circle"></div> <!-- Per-item Circle -->
                <div class="nav-icon-box">
                    <img src="home_icon.svg" class="nav-icon-svg-home">
                </div>
            </div>
            <div class="nav-item" data-target="profile">
                <div class="nav-circle"></div> <!-- Per-item Circle -->
                <div class="nav-icon-box">
                    <img src="settings_icon.svg" class="nav-icon-svg">
                </div>
            </div>
        </div>
    </nav>


    <!-- === MODAL: ANALYZER (Bottom Sheet) === -->
    <div id="modal-analyzer" class="modal-overlay sheet-mode" style="display:none;">
        <div class="modal-content sheet-content"
            style="background: #11101C; border-radius: 24px 24px 0 0; padding: 24px; position: relative; height: 580px; width: 100%; max-width: 480px; margin: 0 auto;">

            <!-- Close Button -->
            <div class="close-modal-btn" onclick="closeAnalyzer()">✕</div>

            <!-- Title -->
            <h2 style="font-family: 'Montserrat', sans-serif; font-size: 20px; margin-bottom: 16px; text-align: center;"
                data-i18n="analyzer_title">AI Chart Analyzer</h2>

            <!-- Description Block -->
            <div
                style="background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 16px; margin-bottom: 24px; border-left: 3px solid #0660F9;">
                <div style="font-size: 14px; line-height: 1.6; color: rgba(255, 255, 255, 0.9);"
                    data-i18n="analyzer_description">
                    <strong style="color: #0660F9;">Black Aladdin</strong> — это AI-аналитик, который изучает ваши
                    графики и предоставляет торговые сигналы.
                    <br><br>
                    <strong>Как работает:</strong>
                    <br>• Загрузите скриншот графика
                    <br>• AI определит тикер и таймфрейм
                    <br>• Получите точки входа, цели и стоп-лосс
                    <br>• См. уровень уверенности и детальные заметки
                </div>
            </div>

            <!-- STEP 1: UPLOAD -->
            <div id="analyzer-step-upload">
                <div class="upload-area" onclick="document.getElementById('chart-input').click()">
                    <div class="upload-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23 19C23 19.5304 22.7893 20.0391 22.4142 20.4142C22.0391 20.7893 21.5304 21 21 21H3C2.46957 21 1.96086 20.7893 1.58579 20.4142C1.21071 20.0391 1 19.5304 1 19V8C1 7.46957 1.21071 6.96086 1.58579 6.58579C1.96086 6.21071 2.46957 6 3 6H7L9 3H15L17 6H21C21.5304 6 22.0391 6.21071 22.4142 6.58579C22.7893 6.96086 23 7.46957 23 8V19Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 17C14.2091 17 16 15.2091 16 13C16 10.7909 14.2091 9 12 9C9.79086 9 8 10.7909 8 13C8 15.2091 9.79086 17 12 17Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                    <div class="upload-text" data-i18n="upload_chart">Tap to upload chart</div>
                    <input type="file" id="chart-input" accept="image/*" style="display: none;"
                        onchange="handleChartUpload(this)">
                </div>
            </div>

            <!-- STEP 2: LOADING -->
            <div id="analyzer-step-loading" style="display: none; text-align: center; padding: 40px 0;">
                <div class="spinner"></div>
                <div style="margin-top: 16px; color: var(--text-secondary); font-size: 14px;"
                    data-i18n="analyzing_market">Analyzing market
                    structure...</div>
            </div>

            <!-- STEP 3: RESULT -->
            <div id="analyzer-step-result" style="display: none;">
                <div class="result-header">
                    <div id="res-ticker" class="res-ticker">BTC/USDT</div>
                    <div id="res-view" class="res-view view-long">LONG</div>
                </div>

                <div class="result-stats">
                    <div class="stat-item">
                        <div class="stat-label" data-i18n="timeframe">Timeframe</div>
                        <div id="res-tf" class="stat-value">1h</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label" data-i18n="confidence">Confidence</div>
                        <div id="res-conf" class="stat-value">85%</div>
                    </div>
                </div>

                <div class="signal-details">
                    <div class="sig-row">
                        <span data-i18n="entry">Entry:</span>
                        <span id="res-entry" class="sig-val">65000 - 65100</span>
                    </div>
                    <div class="sig-row">
                        <span data-i18n="target">Target:</span>
                        <span id="res-target" class="sig-val highlight-green">66500</span>
                    </div>
                    <div class="sig-row">
                        <span data-i18n="stop">Stop:</span>
                        <span id="res-stop" class="sig-val highlight-red">64200</span>
                    </div>
                </div>

                <div id="res-notes" class="result-notes">
                    Bullish divergence on RSI combined with support bounce.
                </div>

                <button onclick="explainSignal()" class="explain-btn">
                    <span data-i18n="explain_logic">Explain Logic</span>
                </button>
                <div id="explanation-text" class="explanation-box" style="display:none;"></div>
            </div>
        </div>
    </div>
    </div>

    <script src="script.js?v=100"></script>
</body>

</html>